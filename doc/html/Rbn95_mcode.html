<pre class="code">
<span class="srcline"><span class="lineno"><a href="51,1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T27U3">R</span> ] = Rbn( <span class="var type1" id="S3T23U6">q</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="51,2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,3"> 3</a></span><span class="line"><span class="comment">%Rbn quaternion rotation matrix ( body to NED)</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,4"> 4</a></span><span class="line">coder.inline(<span class="string">'never'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="51,5"> 5</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,7"> 7</a></span><span class="line"><span class="mxinfo" id="T27:U3"><span class="var type1" id="S2T27U15">R</span> = <span class="mxinfo" id="T27:U5">[<span class="mxinfo" id="T84:U6"><span class="mxinfo" id="T3:U7"><span class="mxinfo" id="T3:U8"><span class="mxinfo" id="T3:U9"><span class="mxinfo" id="T3:U10"><span class="mxinfo" id="T3:U11"><span class="var type1" id="S3T23U23">q</span>(<span class="mxinfo" id="T3:U13">1</span>)</span>.^<span class="mxinfo" id="T3:U14">2</span></span> + <span class="mxinfo" id="T3:U15"><span class="mxinfo" id="T3:U16"><span class="var type1" id="S3T23U28">q</span>(<span class="mxinfo" id="T3:U18">2</span>)</span>.^<span class="mxinfo" id="T3:U19">2</span></span></span> - <span class="mxinfo" id="T3:U20"><span class="mxinfo" id="T3:U21"><span class="var type1" id="S3T23U33">q</span>(<span class="mxinfo" id="T3:U23">3</span>)</span>.^<span class="mxinfo" id="T3:U24">2</span></span></span> - <span class="mxinfo" id="T3:U25"><span class="mxinfo" id="T3:U26"><span class="var type1" id="S3T23U38">q</span>(<span class="mxinfo" id="T3:U28">4</span>)</span>.^<span class="mxinfo" id="T3:U29">2</span></span></span>          <span class="mxinfo" id="T3:U30">2*(<span class="mxinfo" id="T3:U31"><span class="mxinfo" id="T3:U32"><span class="mxinfo" id="T3:U33"><span class="var type1" id="S3T23U47">q</span>(<span class="mxinfo" id="T3:U35">2</span>)</span>.*<span class="mxinfo" id="T3:U36"><span class="var type1" id="S3T23U50">q</span>(<span class="mxinfo" id="T3:U38">3</span>)</span></span>-<span class="mxinfo" id="T3:U39"><span class="mxinfo" id="T3:U40"><span class="var type1" id="S3T23U54">q</span>(<span class="mxinfo" id="T3:U42">1</span>)</span>.*<span class="mxinfo" id="T3:U43"><span class="var type1" id="S3T23U57">q</span>(<span class="mxinfo" id="T3:U45">4</span>)</span></span></span>)</span>             <span class="mxinfo" id="T3:U46">2*(<span class="mxinfo" id="T3:U47"><span class="mxinfo" id="T3:U48"><span class="mxinfo" id="T3:U49"><span class="var type1" id="S3T23U65">q</span>(<span class="mxinfo" id="T3:U51">1</span>)</span>.*<span class="mxinfo" id="T3:U52"><span class="var type1" id="S3T23U68">q</span>(<span class="mxinfo" id="T3:U54">3</span>)</span></span>+<span class="mxinfo" id="T3:U55"><span class="mxinfo" id="T3:U56"><span class="var type1" id="S3T23U72">q</span>(<span class="mxinfo" id="T3:U58">2</span>)</span>.*<span class="mxinfo" id="T3:U59"><span class="var type1" id="S3T23U75">q</span>(<span class="mxinfo" id="T3:U61">4</span>)</span></span></span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="51,8"> 8</a></span><span class="line"><span class="mxinfo" id="T27:U3"><span class="mxinfo" id="T27:U5">         <span class="mxinfo" id="T84:U62"><span class="mxinfo" id="T3:U63">2*(<span class="mxinfo" id="T3:U64"><span class="mxinfo" id="T3:U65"><span class="mxinfo" id="T3:U66"><span class="var type1" id="S3T23U84">q</span>(<span class="mxinfo" id="T3:U68">2</span>)</span>.*<span class="mxinfo" id="T3:U69"><span class="var type1" id="S3T23U87">q</span>(<span class="mxinfo" id="T3:U71">3</span>)</span></span>+<span class="mxinfo" id="T3:U72"><span class="mxinfo" id="T3:U73"><span class="var type1" id="S3T23U91">q</span>(<span class="mxinfo" id="T3:U75">1</span>)</span>.*<span class="mxinfo" id="T3:U76"><span class="var type1" id="S3T23U94">q</span>(<span class="mxinfo" id="T3:U78">4</span>)</span></span></span>)</span>          <span class="mxinfo" id="T3:U79"><span class="mxinfo" id="T3:U80"><span class="mxinfo" id="T3:U81"><span class="mxinfo" id="T3:U82"><span class="mxinfo" id="T3:U83"><span class="var type1" id="S3T23U101">q</span>(<span class="mxinfo" id="T3:U85">1</span>)</span>.^<span class="mxinfo" id="T3:U86">2</span></span> - <span class="mxinfo" id="T3:U87"><span class="mxinfo" id="T3:U88"><span class="var type1" id="S3T23U106">q</span>(<span class="mxinfo" id="T3:U90">2</span>)</span>.^<span class="mxinfo" id="T3:U91">2</span></span></span> + <span class="mxinfo" id="T3:U92"><span class="mxinfo" id="T3:U93"><span class="var type1" id="S3T23U111">q</span>(<span class="mxinfo" id="T3:U95">3</span>)</span>.^<span class="mxinfo" id="T3:U96">2</span></span></span> - <span class="mxinfo" id="T3:U97"><span class="mxinfo" id="T3:U98"><span class="var type1" id="S3T23U116">q</span>(<span class="mxinfo" id="T3:U100">4</span>)</span>.^<span class="mxinfo" id="T3:U101">2</span></span></span>         <span class="mxinfo" id="T3:U102">2*(<span class="mxinfo" id="T3:U103"><span class="mxinfo" id="T3:U104"><span class="mxinfo" id="T3:U105"><span class="var type1" id="S3T23U125">q</span>(<span class="mxinfo" id="T3:U107">3</span>)</span>.*<span class="mxinfo" id="T3:U108"><span class="var type1" id="S3T23U128">q</span>(<span class="mxinfo" id="T3:U110">4</span>)</span></span>-<span class="mxinfo" id="T3:U111"><span class="mxinfo" id="T3:U112"><span class="var type1" id="S3T23U132">q</span>(<span class="mxinfo" id="T3:U114">1</span>)</span>.*<span class="mxinfo" id="T3:U115"><span class="var type1" id="S3T23U135">q</span>(<span class="mxinfo" id="T3:U117">2</span>)</span></span></span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="51,9"> 9</a></span><span class="line"><span class="mxinfo" id="T27:U3"><span class="mxinfo" id="T27:U5">         <span class="mxinfo" id="T84:U118"><span class="mxinfo" id="T3:U119">2*(<span class="mxinfo" id="T3:U120"><span class="mxinfo" id="T3:U121"><span class="mxinfo" id="T3:U122">-<span class="mxinfo" id="T3:U123"><span class="var type1" id="S3T23U145">q</span>(<span class="mxinfo" id="T3:U125">1</span>)</span></span>.*<span class="mxinfo" id="T3:U126"><span class="var type1" id="S3T23U148">q</span>(<span class="mxinfo" id="T3:U128">3</span>)</span></span>+<span class="mxinfo" id="T3:U129"><span class="mxinfo" id="T3:U130"><span class="var type1" id="S3T23U152">q</span>(<span class="mxinfo" id="T3:U132">2</span>)</span>.*<span class="mxinfo" id="T3:U133"><span class="var type1" id="S3T23U155">q</span>(<span class="mxinfo" id="T3:U135">4</span>)</span></span></span>)</span>               <span class="mxinfo" id="T3:U136">2*(<span class="mxinfo" id="T3:U137"><span class="mxinfo" id="T3:U138"><span class="mxinfo" id="T3:U139"><span class="var type1" id="S3T23U163">q</span>(<span class="mxinfo" id="T3:U141">3</span>)</span>.*<span class="mxinfo" id="T3:U142"><span class="var type1" id="S3T23U166">q</span>(<span class="mxinfo" id="T3:U144">4</span>)</span></span>+<span class="mxinfo" id="T3:U145"><span class="mxinfo" id="T3:U146"><span class="var type1" id="S3T23U170">q</span>(<span class="mxinfo" id="T3:U148">1</span>)</span>.*<span class="mxinfo" id="T3:U149"><span class="var type1" id="S3T23U173">q</span>(<span class="mxinfo" id="T3:U151">2</span>)</span></span></span>)</span>        <span class="mxinfo" id="T3:U152"><span class="mxinfo" id="T3:U153"><span class="mxinfo" id="T3:U154"><span class="mxinfo" id="T3:U155"><span class="mxinfo" id="T3:U156"><span class="var type1" id="S3T23U180">q</span>(<span class="mxinfo" id="T3:U158">1</span>)</span>.^<span class="mxinfo" id="T3:U159">2</span></span> - <span class="mxinfo" id="T3:U160"><span class="mxinfo" id="T3:U161"><span class="var type1" id="S3T23U185">q</span>(<span class="mxinfo" id="T3:U163">2</span>)</span>.^<span class="mxinfo" id="T3:U164">2</span></span></span> - <span class="mxinfo" id="T3:U165"><span class="mxinfo" id="T3:U166"><span class="var type1" id="S3T23U190">q</span>(<span class="mxinfo" id="T3:U168">3</span>)</span>.^<span class="mxinfo" id="T3:U169">2</span></span></span> + <span class="mxinfo" id="T3:U170"><span class="mxinfo" id="T3:U171"><span class="var type1" id="S3T23U195">q</span>(<span class="mxinfo" id="T3:U173">4</span>)</span>.^<span class="mxinfo" id="T3:U174">2</span></span></span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,11">11</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
